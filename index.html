<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>vocadal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Cozy serif font (used ONLY for the word itself + title) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #eee6da;
      --card: #f3ecdf;
      --accent: #bfae94;
      --text: #3a342d;
      --muted: #6f665b;
      --border: #d6cbb8;
      --correct: #5f7f63;
      --wrong: #a86161;
    }

    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system;
    }

    body {
      margin: 0;
      background: var(--bg);
      display: flex;
      justify-content: center;
      padding: 28px;
      color: var(--text);
    }

    .container {
      max-width: 820px;
      width: 100%;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      margin-bottom: 18px;
    }

    .app-title {
      font-family: "Cormorant Garamond", serif;
      font-size: 2.6rem;
      font-weight: 500;
      letter-spacing: 1px;
      margin-bottom: 4px;
    }

    .title-sub {
      font-family: "Cormorant Garamond", serif;
      font-size: 1rem;
      letter-spacing: 0.6px;
      color: var(--muted);
    }

    .tabs {
      display: flex;
      gap: 6px;
      margin-top: 10px;
    }

    .tabs button {
      font-size: 0.85rem;
    }

    .date-controls {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    button {
      background: var(--card);
      border: 1px solid var(--border);
      padding: 8px 14px;
      border-radius: 10px;
      cursor: pointer;
      color: var(--text);
    }

    button:hover {
      background: #e9e0d2;
    }

    input[type="date"] {
      padding: 7px 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--card);
    }

    .card {
      background: var(--card);
      border-radius: 18px;
      padding: 26px;
      border: 1px solid var(--border);
      box-shadow: 0 12px 30px rgba(0,0,0,0.06);
    }

    .word {
      margin-bottom: 28px;
    }

    .word-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .word h2 {
      margin: 0;
      font-size: 1.7rem;
      font-family: "Cormorant Garamond", serif;
    }

    .bookmark {
      cursor: pointer;
      font-size: 1.2rem;
      color: var(--muted);
    }

    .bookmark.saved {
      color: #8b6f47;
    }

    .meta {
      font-size: 0.9rem;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .example {
      font-style: italic;
      color: #544d44;
      margin-top: 6px;
    }

    .practice-box {
      margin-top: 36px;
      padding-top: 22px;
      border-top: 1px solid var(--border);
    }

    .question {
      margin-bottom: 18px;
    }

    select {
      width: 100%;
      padding: 9px 10px;
      margin-top: 6px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #efe7d9;
    }

    .submit-btn {
      margin-top: 10px;
      background: var(--accent);
      border: none;
      font-weight: 600;
    }

    .correct {
      border-color: var(--correct);
      background: #e1ece3;
    }

    .wrong {
      border-color: var(--wrong);
      background: #f0dcdc;
    }
  </style>
</head>

<body>
<div class="container">
  <header>
    <div>
      <div class="app-title">vocadal</div>
      <div class="title-sub">noun · ˈvoʊkədæl</div>
      <div class="tabs">
        <button id="tab-today">Today</button>
        <button id="tab-saved">Saved</button>
      </div>
    </div>

    <div class="date-controls">
      <button id="prev">←</button>
      <input type="date" id="picker">
      <button id="next">→</button>
    </div>
  </header>

  <div class="card" id="content">Loading…</div>
</div>

<script>
  const content = document.getElementById("content");
  const picker = document.getElementById("picker");
  let currentDate = new Date();
  currentDate.setHours(0,0,0,0);

  const format = d => d.toISOString().split("T")[0];
  const shuffle = a => [...a].sort(() => Math.random() - 0.5);

  const getSaved = () => JSON.parse(localStorage.getItem("vocadalSaved") || "{}");
  const saveWord = w => {
    const s = getSaved();
    s[w.word] = w;
    localStorage.setItem("vocadalSaved", JSON.stringify(s));
  };
  const removeWord = word => {
    const s = getSaved();
    delete s[word];
    localStorage.setItem("vocadalSaved", JSON.stringify(s));
  };

  function loadDay(date) {
    const year = date.getFullYear();
    const month = String(date.getMonth()+1).padStart(2,"0");
    const key = format(date);
    picker.value = key;

    fetch(`data/${year}-${month}.json`)
      .then(r => r.json())
      .then(data => {
        const day = data.days[key];
        if (!day) {
          content.innerHTML = "<p>No words for this day.</p>";
          return;
        }

        const saved = getSaved();
        const options = day.words.map(w => w.word);

        content.innerHTML = day.words.map(w => `
          <div class="word">
            <div class="word-header">
              <h2>${w.word}</h2>
              <span class="bookmark ${saved[w.word] ? "saved" : ""}" data-word='${JSON.stringify(w)}'>
                ${saved[w.word] ? "★" : "☆"}
              </span>
            </div>
            <div class="meta">${w.partOfSpeech} • ${w.pronunciation}</div>
            <p>${w.definition}</p>
            <div class="example">“${w.usage}”</div>
          </div>
        `).join("");

        content.innerHTML += `
          <div class="practice-box">
            <h3>Practice</h3>
            ${shuffle(day.words).map(w => `
              <div class="question">
                <div>${w.practice.fillBlank}</div>
                <select data-answer="${w.word}">
                  <option value="">Select a word</option>
                  ${shuffle(options).map(o => `<option>${o}</option>`).join("")}
                </select>
              </div>
            `).join("")}
            <button class="submit-btn" id="submit">Submit Practice</button>
          </div>
        `;

        document.querySelectorAll(".bookmark").forEach(b => {
          b.onclick = () => {
            const w = JSON.parse(b.dataset.word);
            if (getSaved()[w.word]) {
              removeWord(w.word);
              b.textContent = "☆";
              b.classList.remove("saved");
            } else {
              saveWord(w);
              b.textContent = "★";
              b.classList.add("saved");
            }
          };
        });

        document.getElementById("submit").onclick = () => {
          document.querySelectorAll("select").forEach(s => {
            if (!s.value) return;
            s.classList.toggle("correct", s.value === s.dataset.answer);
            s.classList.toggle("wrong", s.value !== s.dataset.answer);
          });
        };
      });
  }

  function loadSaved() {
    const saved = Object.values(getSaved());
    if (!saved.length) {
      content.innerHTML = "<p>No saved words yet.</p>";
      return;
    }
    content.innerHTML = saved.map(w => `
      <div class="word">
        <div class="word-header">
          <h2>${w.word}</h2>
          <span class="bookmark saved">★</span>
        </div>
        <div class="meta">${w.partOfSpeech} • ${w.pronunciation}</div>
        <p>${w.definition}</p>
        <div class="example">“${w.usage}”</div>
      </div>
    `).join("");
  }

  document.getElementById("prev").onclick = () => {
    currentDate.setDate(currentDate.getDate()-1);
    loadDay(currentDate);
  };
  document.getElementById("next").onclick = () => {
    currentDate.setDate(currentDate.getDate()+1);
    loadDay(currentDate);
  };
  picker.onchange = e => {
    currentDate = new Date(e.target.value);
    currentDate.setHours(0,0,0,0);
    loadDay(currentDate);
  };

  document.getElementById("tab-today").onclick = () => loadDay(currentDate);
  document.getElementById("tab-saved").onclick = loadSaved;

  loadDay(currentDate);
</script>
</body>
</html>